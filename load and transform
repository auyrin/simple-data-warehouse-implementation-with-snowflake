// load sales data from s3 buckets

COPY INTO DWH.STAGING.SALES_RAW
    FROM @DWH.EXTERNAL_STAGES.AWS_STAGE
    FILE_FORMAT = MANAGE_DB.FILE_FORMATS.CSV_FILEFORMAT
    pattern = ".*Fact_Sales.*";



// load the product data from s3 buckets

COPY INTO DWH.STAGING.PRODUCTS_RAW
        FROM @DWH.EXTERNAL_STAGES.AWS_STAGE
        FILE_FORMAT = MANAGE_DB.FILE_FORMATS.CSV_FILEFORMAT
        PATTERN = ".*products.*";

// VIEW THE sales fact TABLE
SELECT * FROM DWH.STAGING.SALES_RAW;


// we need to pair the payment together with the loyalty card
// it might be better to even make it it's own dimension (payment_dim)
select 
    distinct coalesce("payment", 'cash') as payment,
    "loyalty_card"
from dwh.STAGING.sales_raw;

// create the core payment dimension in the creation file tab


// the final sales table (core sales table) will hold extra calculations like
// total amount, total profit, payment_key, product_pk


SELECT * FROM DWH.STAGING.PRODUCT_RAW;
// transform the column product(brand) into two different columns product and brand

